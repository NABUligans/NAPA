PPROP ".SYSTEM "BURY "TRUE
TO SAD 
SETC 4
IF MEMBERP :C :L [SETY YCOR - 7 SETC 4 SETSH :C] [SETSH :C]
WAIT 100
CHANGE.COLOR 10 0
HT PU SETPOS [-14 23] PD SETH 0
SETPC 10 REPEAT 18 [FD 2 RT 10]
FD 2 PU
WAIT 40
CHANGE.COLOR 10 0
HAPPY SETPOS :X
END

TO PRLE :V
SETC 0
IF MEMBERP :V [28 32 36 42 48 52] [SETPC 6] [SETPC 2]
SETSH :V
MAKE "L [34 37 43 44 52]
IF MEMBERP :V :L [SETY YCOR - 7 STAMP SETY YCOR + 7] [STAMP]
SETX XCOR + 30
END

TO FACE 
HT PU SETPOS [-30 40]
PD SETPC 11 SETC 11
REPEAT 36 [FD 5 RT 10]
SETSH 30 PU SETPOS [-30 40]
REPEAT 10 [FD 10 RT 18 STAMP]
HT
SETPOS [-10 55]
SETSH 42 STAMP
PU SETX XCOR + 22
STAMP
HT
END

TO HAPPY 
SETPC 10
PU SETPOS [-14 33] PD SETH 0
REPEAT 19 [LT 9 BK 2] BK 2 PU
END

TO INPUT :INPUT :V
IF :INPUT > 4 [STOP]
SETC 4
LABEL "INPUT
IF NOT CHARP [FLASH] [FLUSH GO "INPUT]
IF :C = 152 [STOP]
IF OR :C < 28 :C > 54 [GO "INPUT]
MAKE "X POS
IF :C = :V [SOUND] [SAD GO "INPUT]
SETX XCOR + 30
MAKE "Z 0
INPUT :INPUT + 1 :V + 2
END

TO START 
CS SETBG 1 SETTC 15
SETCURSOR [6 0] SETTC [1 11] TYPE [* * ABC SMALL * *]
SETTC [0 0]
LOADSH "ALPHA
FACE HAPPY MAKE "T 1
LABEL "START
MAKE "V 28 + RANDOM 19
PU SETPOS [-105 -55]
REPEAT 4 [PRLE :V MAKE "V :V + 2 SETY -60 PRLE 55 SETY -55]
SETPOS [-75 -55]
INPUT 1 :V - 7
IF :C = 152 [GO "END]
CHANGE.COLOR 2 0 CHANGE.COLOR 6 0
MAKE "T :T + 1
IF :T < 5 [GO "START]
LABEL "END
CS HT
END

TO FLASH 
SETSH 26 WAIT 20
LABEL "FLASH
IF SHOWNP [HT] [SHOW] WAIT 20
IF CHARP [MAKE "C RC] [GO "FLASH]
IF AND ASCII :C > 96 ASCII :C < 123 [MAKE "C (ASCII :C) - 69] [MAKE "C (ASCII :C) - 37]
END

TO FLUSH 
LABEL "FLUSH
MAKE "Z RC
IF CHARP [GO "FLUSH]
END

TO SOUND 
PRLE :V HT SETPC 10 MAKE "X POS
.AUDIOWRITE 7 62
.AUDIOWRITE 8 16
.AUDIOWRITE 1 0
.AUDIOWRITE 0 250
.AUDIOWRITE 12 40
.AUDIOWRITE 11 250
.AUDIOWRITE 13 0
SETPOS :X
END

]
IF OR :C < 28 :C > 54 [GO "INPUT]
MAKE "X POS
IF :C = :V [SOUND] [SAD GO "INPUT]
SETX XCOR + 30
MAKE "Z 0
INPUT :INPUT + 1 :V + 2
END
‚©